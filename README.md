这是一个SURT/SPI通信实验的工程，基于SEA-spartan7开发板。

运用到的外设主要有：按键RST，按键KEY1，LED1、LED2

通信实验本来应该用两块板子，但是目前手头只有一块可以用的，因此把发送接收（或SPI的主从）全都写在了一块板子中。本应在外部的接线也直接写在了FPGA内部。程序的功能如下：

程序中包含USRT和SPI两种协议，可以通过外部控制实现模式的转换。按动黑色的RST按键，程序复位，默认复位通信模式为UART，LED灯灭。

在UART模式中，没有主从关系，只有发送和接收模块。程序逻辑是：发送10位有效位，其中包含2位地址位和8位数据位。接收端首先接收该10位有效位，判断地址是否与自己的地址相符合。若和自己的地址相同，则暂存数据；若和自己的地址不同，则舍弃接收到的数据。在数据接受完毕后给出数据和数据有效信号。这两个信号接到驱动LED灯的一级。判断数据，若等于8'hbb，则点亮LED2，若不等于，则不点亮。在UART模式中，LED1始终不点亮。

按动板子上的KEY1，可以实现UART和SPI模式的转换。在UART模式下，按动KEY1，程序转换到SPI模式。

在SPI模式中，主机通过ss_n信号轮流选择从机，并给从机发送8'hbb信号。被选中的从机也给主机发送8'hbb数据。从机首先通过ss_n信号判断主机是否给其发送数据，然后接收数据。接收完数据后给到data_receive端口并拉高data_receive_valid信号。后面是一级LED驱动模块。和UART中的类似，若判断接收到的数据位8'hbb，则点亮LED2。主机侧和从机类似，接受数据后，通过led驱动模块判断是否等于8'hbb，若等于，则点亮LED1。在程序中，主机可以接四个从机，但是实际上只接了一个。而又由于主机是轮流和从机通信，因此主机的LED等实际上不是一直亮，只有1/4的时间才会点亮。由于人眼的视觉暂留效果，LED1从感官上是常亮，但是亮度弱于LED2.

程序验证方法：
将bit文件烧写进FPGA后，按动RST按键后，首先看到红色LED2亮。这是因为复位后的电路默认是UART模式，且通信速率很快，立刻接收端就收到了8'hbb，点亮LED2。在UART模式下，LED1一直不点亮。

按动KEY1，看到红色的LED2和绿色的LED1同时点亮，且绿色灯光弱于红色。这是因为按动KEY1之后系统转换成了SPI模式，主机和从机都会接收数据，且主机只有1/4时间内接受的数据才是有效的。

再次按动RST，系统复位回到UART模式。再次按动KEY1，系统回到SPI模式。再次按动KEY1，系统又回到UART模式
